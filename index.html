<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StyleHero X</title>
    <style>
        :root { --apple-blue: #0071e3; --glass: rgba(255, 255, 255, 0.8); }
        body { background: #f5f5f7; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; display: flex; justify-content: center; min-height: 100vh; color: #1d1d1f; }
        .container { width: 90%; max-width: 440px; padding: 40px 0; text-align: center; }
        
        /* 頂部導航 */
        h1 { font-weight: 700; font-size: 28px; letter-spacing: -0.5px; margin-bottom: 10px; }
        .subtitle { color: #86868b; font-size: 14px; margin-bottom: 30px; }

        /* 性別切換器 */
        .switch-box { display: flex; background: #e3e3e7; padding: 3px; border-radius: 20px; width: 200px; margin: 0 auto 30px; }
        .s-btn { flex: 1; padding: 8px; border-radius: 17px; border: none; font-size: 13px; font-weight: 600; cursor: pointer; transition: 0.3s; color: #86868b; background: transparent; }
        .s-btn.active { background: white; color: #1d1d1f; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }

        /* AI 模擬舞台 */
        .stage { 
            position: relative; width: 320px; height: 420px; background: white; 
            margin: 0 auto 30px; border-radius: 35px; overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center;
        }
        #model { width: 90%; height: 90%; object-fit: contain; transition: 0.5s; filter: grayscale(0.2); }
        #overlay { 
            position: absolute; width: 75%; height: 75%; top: 15%;
            mix-blend-mode: multiply; opacity: 0; transition: 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            filter: contrast(1.1) brightness(1.1); pointer-events: none;
        }

        /* 控制區域 */
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
        .up-card { background: white; padding: 15px; border-radius: 18px; border: 1px solid #d2d2d7; cursor: pointer; font-size: 14px; font-weight: 500; transition: 0.2s; }
        .up-card:active { transform: scale(0.98); background: #f5f5f7; }

        /* 誠實診斷面板 */
        .result-panel { 
            background: var(--glass); backdrop-filter: blur(10px); border-radius: 22px; 
            padding: 20px; text-align: left; display: none; border: 1px solid rgba(255,255,255,0.3);
        }
        .score-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .score-val { font-size: 24px; font-weight: 700; color: var(--apple-blue); }
        .bar-bg { height: 6px; background: #e3e3e7; border-radius: 3px; overflow: hidden; }
        .bar-fill { height: 100%; background: var(--apple-blue); width: 0%; transition: 1.5s cubic-bezier(0.1, 0.7, 0.1, 1); }
        canvas { display: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>StyleHero <span style="color:var(--apple-blue)">X</span></h1>
    <p class="subtitle">AI 穿搭氛圍模擬器</p>

    <div class="switch-box">
        <button id="m-btn" class="s-btn active" onclick="setG('m')">男 性</button>
        <button id="f-btn" class="s-btn" onclick="setG('f')">女 性</button>
    </div>

    <div class="stage">
        <img id="model" src="https://www.freeiconspng.com/uploads/man-silhouette-icon-10.png" alt="model">
        <img id="overlay" alt="cloth">
    </div>

    <div class="controls">
        <label class="up-card">＋ 加入單品<input type="file" hidden onchange="process(this)"></label>
        <label class="up-card">＋ 加入飾品<input type="file" hidden onchange="process(this)"></label>
    </div>

    <div id="res" class="result-panel">
        <div class="score-row">
            <span style="font-weight: 600;">誠實配色評分</span>
            <span id="score" class="score-val">0</span>
        </div>
        <div class="bar-bg"><div id="fill" class="bar-fill"></div></div>
        <p id="feedback" style="font-size: 13px; color: #424245; margin-top: 12px; line-height: 1.5;"></p>
    </div>
</div>

<canvas id="c"></canvas>

<script>
    const imgs = {
        m: "https://www.freeiconspng.com/uploads/man-silhouette-icon-10.png",
        f: "https://www.freeiconspng.com/uploads/female-icon-png-27.png"
    };

    function setG(g) {
        document.getElementById('m-btn').classList.toggle('active', g === 'm');
        document.getElementById('f-btn').classList.toggle('active', g === 'f');
        document.getElementById('model').src = imgs[g];
    }

    function process(input) {
        const file = input.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            const over = document.getElementById('overlay');
            over.src = e.target.result;
            over.style.opacity = "0.85";
            // 奇妙角度隨機生成
            const rot = (Math.random() * 14 - 7);
            over.style.transform = `scale(1.1) rotate(${rot}deg)`;
            
            // 執行誠實配色診斷
            const img = new Image();
            img.src = e.target.result;
            img.onload = function() {
                const cvs = document.getElementById('c');
                const ctx = cvs.getContext('2d');
                cvs.width = 10; cvs.height = 10;
                ctx.drawImage(img, 0, 0, 10, 10);
                const d = ctx.getImageData(5, 5, 1, 1).data;
                const score = Math.floor(Math.random() * 20) + 75; // 模擬AI計算
                showRes(score, d);
            }
        };
        reader.readAsDataURL(file);
    }

    function showRes(s, rgb) {
        const panel = document.getElementById('res');
        panel.style.display = 'block';
        document.getElementById('score').innerText = s;
        document.getElementById('fill').style.width = s + '%';
        
        let msg = "【誠實診斷】這件單品的色彩飽和度適中。";
        if(rgb[0] > 200 && rgb[1] > 200) msg += "亮色系能有效提升面部氣色，建議搭配深色下裝。";
        else msg += "深沉的色調展現了穩重的質感，適合正式場合。";
        
        document.getElementById('feedback').innerText = msg;
    }
</script>

</body>
</html>
